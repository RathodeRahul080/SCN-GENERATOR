<!DOCTYPE html>
<html>
<head>
  <title>SCN Generator - GST Format</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.7.0/docx.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: auto; padding: 20px; }
    input, textarea, select { width: 100%; margin: 10px 0; padding: 8px; }
    button { padding: 10px 15px; margin-top: 15px; }
  </style>
  <style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    max-width: 900px;
    margin: auto;
    padding: 20px;
    background: #f8f9fa;
  }

  #preview {
    background: white;
    color: black;
    padding: 40px;
    margin-top: 20px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }

  #previewContent h2, #previewContent h3 {
    text-align: center;
    margin-bottom: 5px;
  }

  #previewContent p, #previewContent ul, #previewContent ol {
    text-align: justify;
    line-height: 1.6;
    margin: 10px 0;
  }

  #previewContent table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
  }

  #previewContent table, #previewContent th, #previewContent td {
    border: 1px solid #333;
  }

  #previewContent th, #previewContent td {
    padding: 8px;
    text-align: center;
  }

  @media print {
    body * {
      visibility: hidden;
    }

    #preview, #preview * {
      visibility: visible;
    }

    #preview {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      box-shadow: none;
      margin: 0;
    }

    button, select, input, textarea {
      display: none !important;
    }
  }
</style>
</head>
<body>

<h2>Show Cause Notice Generator (Sec. 73 / 74)</h2>

<label>Section Applicable:</label>
<select id="section">
  <option value="73">Section 73 – Non-fraud (short payment/error)</option>
  <option value="74" selected>Section 74 – Fraud/willful misstatement</option>
</select>

<label>Trader Name:</label>
<input type="text" id="traderName" value="M/s. AMEENA TRADERS">

<label>GSTIN:</label>
<input type="text" id="gstin" value="37BDEPD5901P1ZD">

<label>Address:</label>
<textarea id="address">WARD NO.9, MAIN ROAD, GAJULAPALLE, Nandyal, Andhra Pradesh, 518501</textarea>

<label>Tax Period:</label>
<input type="text" id="taxPeriod" value="October 2018">

<label>Tax Amount (₹):</label>
<input type="number" id="taxAmount" value="31680">

<label>Date Tax Was Due (YYYY-MM-DD):</label>
<input type="date" id="dueDate" value="2018-11-20">

<label>Officer Designation:</label>
<input type="text" id="officer" value="SUPERINTENDENT">

<label>Place:</label>
<input type="text" id="place" value="KURNOOL">

<button onclick="generateDoc()">Download SCN as Word</button>
<script>
    function generatePreview() {
  const section = document.getElementById("section").value;
  const traderName = document.getElementById("traderName").value;
  const gstin = document.getElementById("gstin").value;
  const address = document.getElementById("address").value;
  const taxPeriod = document.getElementById("taxPeriod").value;
  const taxAmount = parseFloat(document.getElementById("taxAmount").value);
  const dueDate = new Date(document.getElementById("dueDate").value);
  const officer = document.getElementById("officer").value;
  const place = document.getElementById("place").value;
  const today = new Date().toLocaleDateString('en-GB');

  const daysLate = Math.max(0, Math.floor((new Date() - dueDate) / (1000 * 60 * 60 * 24)));
  const interest = Math.round(taxAmount * 0.18 * (daysLate / 365));
  const penalty = section === "74" ? taxAmount : Math.max(taxAmount * 0.10, 10000);
  const total = taxAmount + interest + penalty;

  const sectionTitle = section === "74" ? "Section 74 – Fraud/willful misstatement" : "Section 73 – Non-fraudulent tax short payment";
  const penaltyRef = section === "74" ? "Section 74 and Section 122(2)(b)" : "Section 73(9)";

  const html = `
    <h2 style="text-align:center;">OFFICE OF THE SUPERINTENDENT OF CENTRAL TAX</h2>
    <p style="text-align:center;">CENTRAL GST RANGE: NANDYAL-I, NEAR CHILDREN PARK, N.R. PETA, KURNOOL - 518001</p>
    <p><strong>Date:</strong> ${today}</p>
    <p><strong>To:</strong><br>${traderName}<br>${address}</p>
    <h3>Subject: Show Cause Notice under ${sectionTitle}</h3>
    <p>${traderName}, registered under GST (GSTIN: ${gstin}), is found liable for the following tax discrepancies for the period ${taxPeriod}:</p>
    <table border="1" cellspacing="0" cellpadding="6" style="width:100%; border-collapse:collapse;">
      <tr><th>Tax Amount (₹)</th><th>Interest (₹)</th><th>Penalty (₹)</th><th>Total (₹)</th></tr>
      <tr><td>${taxAmount}</td><td>${interest}</td><td>${penalty}</td><td>${total}</td></tr>
    </table>
    <p><strong>Legal Provisions:</strong></p>
    <ul>
      <li>Section 59 – Self-assessment</li>
      <li>Section 9 – Levy and Collection of Tax</li>
      <li>Section 50 – Interest on delayed payment of tax</li>
      <li>${section === "74" ? "Section 74 – Fraud / suppression of facts" : "Section 73 – Tax short paid without fraud"}</li>
      <li>${penaltyRef} – Penalty provisions</li>
      <li>Rule 138 – E-Way Bill compliance</li>
      <li>Section 39 – Return filing</li>
      <li>Section 20 of IGST Act</li>
    </ul>
    <p>You are hereby directed to show cause within 30 days why:</p>
    <ol>
      <li>Tax of ₹${taxAmount} should not be demanded</li>
      <li>Interest of ₹${interest} should not be recovered</li>
      <li>Penalty of ₹${penalty} should not be imposed</li>
    </ol>
    <p>Failure to reply within the stipulated time will result in ex-parte adjudication. You may submit supporting documents or request a personal hearing.</p>
    <p><strong>Place:</strong> ${place}<br><strong>Date:</strong> ${today}</p>
    <p><strong>${officer}</strong><br>NANDYAL-I CGST RANGE</p>
  `;

  const previewDiv = document.getElementById("previewContent");
  previewDiv.innerHTML = html;

  // Show preview & trigger print
  const previewWrapper = document.getElementById("preview");
  previewWrapper.style.display = "block";

  setTimeout(() => {
    window.print();
    previewWrapper.style.display = "none";
  }, 300);
}
async function generateDoc() {
  const { Document, Packer, Paragraph, TextRun, Table, TableRow, TableCell, WidthType } = window.docx;

  const section = document.getElementById("section").value;
  const traderName = document.getElementById("traderName").value;
  const gstin = document.getElementById("gstin").value;
  const address = document.getElementById("address").value;
  const taxPeriod = document.getElementById("taxPeriod").value;
  const taxAmount = parseFloat(document.getElementById("taxAmount").value);
  const dueDate = new Date(document.getElementById("dueDate").value);
  const officer = document.getElementById("officer").value;
  const place = document.getElementById("place").value;
  const today = new Date();
  const todayStr = today.toLocaleDateString('en-GB');

  const daysLate = Math.max(0, Math.floor((today - dueDate) / (1000 * 60 * 60 * 24)));
  const interest = Math.round(taxAmount * 0.18 * (daysLate / 365));

  let penalty = 0;
  let penaltyText = "";
  let sectionTitle = "";
  let legalRefs = [];

  if (section === "74") {
    penalty = taxAmount;
    penaltyText = `₹${penalty} as penalty under Section 74 and Section 122(2)(b)`;
    sectionTitle = "Section 74 – Fraud/willful misstatement";
    legalRefs = [
      "Section 59 – Self-assessment",
      "Section 9 – Levy and Collection of Tax",
      "Section 50 – Interest on delayed payment of tax",
      "Section 74 – Tax not paid/short paid due to suppression/fraud",
      "Section 122(2)(b) – Penalty for evasion",
      "Rule 138 – E-Way Bill compliance",
      "Section 39 – Return filing",
      "Section 20 of IGST Act – Applicability of CGST to IGST"
    ];
  } else {
    penalty = Math.max(taxAmount * 0.10, 10000);
    penaltyText = `₹${penalty} as penalty under Section 73(9)`;
    sectionTitle = "Section 73 – Non-fraudulent tax short payment";
    legalRefs = [
      "Section 59 – Self-assessment",
      "Section 9 – Levy and Collection of Tax",
      "Section 50 – Interest on delayed payment of tax",
      "Section 73 – Tax short paid or unpaid without fraud",
      "Section 73(9) – Penalty for non-fraud cases",
      "Rule 138 – E-Way Bill compliance",
      "Section 39 – Return filing",
      "Section 20 of IGST Act – Applicability of CGST to IGST"
    ];
  }

  const para = (text, bold = false) => new Paragraph({ children: [new TextRun({ text, bold })] });

  const doc = new Document({
    sections: [{
      children: [
        new Paragraph({ text: "OFFICE OF THE SUPERINTENDENT OF CENTRAL TAX", heading: "Heading1" }),
        para("CENTRAL GST RANGE: NANDYAL-I"),
        para("NEAR CHILDREN PARK, N.R. PETA, KURNOOL - 518001, ANDHRA PRADESH"),
        para(`File No.: OC No. 93/2025           Date: ${todayStr}`),
        new Paragraph(""),
        para("To,"),
        para(`${traderName},`),
        para(`${address}`),
        new Paragraph(""),
        para(`Subject: Non-payment of GST liability – Issuance of Show Cause Notice under ${sectionTitle} – Reg.`, true),
        new Paragraph(""),
        para(`${traderName}, ${address}, hereinafter referred to as 'the taxpayer', are registered under CGST Act, 2017 vide GSTIN: ${gstin}.`),
        para("Audit revealed the taxpayer generated e-way bills without filing corresponding returns. These were reported by AG Audit."),
        para("On verification, the following liabilities were identified:"),

        new Table({
          rows: [
            new TableRow({
              children: ["Tax Period", "Tax Amount", "Interest", "Penalty", "Total"].map(text =>
                new TableCell({
                  width: { size: 20, type: WidthType.PERCENTAGE },
                  children: [new Paragraph({ text, bold: true })]
                })
              )
            }),
            new TableRow({
              children: [
                taxPeriod,
                `₹${taxAmount}`,
                `₹${interest}`,
                `₹${penalty}`,
                `₹${taxAmount + interest + penalty}`
              ].map(text =>
                new TableCell({
                  width: { size: 20, type: WidthType.PERCENTAGE },
                  children: [new Paragraph(text)]
                })
              )
            })
          ]
        }),

        para(""),
        para("Legal Provisions involved include:"),
        ...legalRefs.map(ref => para("- " + ref)),

        para(""),
        para("You are hereby required to Show Cause within 30 days as to why:"),
        para(`1. ₹${taxAmount} as IGST for ${taxPeriod} should not be demanded`),
        para(`2. ₹${interest} as interest under Section 50 should not be recovered`),
        para(`3. ${penaltyText}`),

        para("If no reply is received within the stipulated time, the case will be decided ex-parte on merits. Supporting documents and hearing requests may be submitted."),
        para("This notice is issued without prejudice to any other legal action under the GST laws."),
        para("Reliance is placed on the documents already available with the taxpayer."),

        para(""),
        para(`Place: ${place}`),
        para(`Date: ${todayStr}`),
        para(""),
        para(`${officer}`),
        para("NANDYAL-I CGST RANGE")
      ]
    }]
  });

  const blob = await Packer.toBlob(doc);
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = `SCN_${section}_GST.docx`;
  link.click();
}
</script>
  <div id="preview" style="display:none;">
  <div id="previewContent"></div>
</div>
</body>
</html>
