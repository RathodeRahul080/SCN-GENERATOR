from docx import Document
from docx.shared import Pt
from datetime import date

def generate_scn(trader_name, gstin, address, tax_period, tax_amount, interest, penalty):
    doc = Document()

    # Header
    doc.add_heading('OFFICE OF THE ASSISTANT COMMISSIONER OF STATE TAX', level=1)
    doc.add_paragraph('COMMERCIAL TAXES DEPARTMENT\n[Your Office Address Here]')

    doc.add_paragraph(f"File No: [Insert File Number Here]       Date: {date.today().strftime('%d-%m-%Y')}")

    # Recipient
    doc.add_paragraph(f"To,\n{trader_name},\n{address}")

    # Subject
    doc.add_paragraph("Subject: SHOW CAUSE NOTICE UNDER SECTION 73 OF THE CGST ACT, 2017", style='Intense Quote')

    # Body
    doc.add_paragraph(
        f"This office has examined your case and it appears that you, being a registered person under GST having "
        f"GSTIN {gstin}, have short paid tax or erroneously claimed refund or input tax credit without any fraudulent intent "
        f"during the tax period {tax_period}. This notice is being issued under Section 73 of the CGST Act, 2017."
    )

    doc.add_paragraph("The discrepancy noticed is summarized as under:")

    # Table
    table = doc.add_table(rows=1, cols=5)
    hdr_cells = table.rows[0].cells
    hdr_cells[0].text = 'Tax Period'
    hdr_cells[1].text = 'Tax Amount (₹)'
    hdr_cells[2].text = 'Interest (₹)'
    hdr_cells[3].text = 'Penalty (₹)'
    hdr_cells[4].text = 'Total (₹)'

    row_cells = table.add_row().cells
    row_cells[0].text = tax_period
    row_cells[1].text = f"{tax_amount:.2f}"
    row_cells[2].text = f"{interest:.2f}"
    row_cells[3].text = f"{penalty:.2f}"
    row_cells[4].text = f"{tax_amount + interest + penalty:.2f}"

    # Legal references
    doc.add_paragraph(
        "This notice is being issued under the provisions of Section 73(1) of the CGST Act, 2017 read with Rule 142(1) "
        "of the CGST Rules, 2017. You are required to show cause as to why the said amount along with applicable interest "
        "under Section 50 and penalty under Section 73(9) should not be recovered from you."
    )

    doc.add_paragraph(
        "You are directed to submit your written reply within 30 days from the date of receipt of this notice. "
        "In case no satisfactory reply is received within the stipulated time, the case will be decided ex-parte on merits."
    )

    # Closing
    doc.add_paragraph("\nPlace: [Your City]\nDate: " + date.today().strftime('%d-%m-%Y'))
    doc.add_paragraph("\n(Your Name)\nAssistant Commissioner of State Tax")

    doc.save("Show_Cause_Notice.docx")
